<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thailand Ultimate Guide - Interactieve Kaart</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }
        #map { height: 100vh; width: 100%; z-index: 1; }
        
        /* Sidebar Controls */
        #controls {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            width: 280px;
            max-height: 90vh;
            overflow-y: auto;
            backdrop-filter: blur(5px);
        }

        h2 { margin-top: 0; font-size: 20px; color: #333; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        h4 { margin: 15px 0 5px 0; font-size: 14px; color: #555; text-transform: uppercase; letter-spacing: 1px; }

        .filter-group { margin-bottom: 15px; }
        .filter-group label { display: flex; align-items: center; margin-bottom: 6px; cursor: pointer; font-size: 14px; }
        
        input[type="checkbox"] { margin-right: 10px; accent-color: #007bff; transform: scale(1.1); }
        select { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; background: white; }

        /* Slider Style */
        .slider-container { margin-bottom: 15px; }
        input[type=range] { width: 100%; margin: 10px 0; cursor: pointer; }
        .slider-val { font-weight: bold; color: #007bff; float: right; }

        /* Legenda stippen */
        .legend-color { display: inline-block; width: 12px; height: 12px; border-radius: 50%; margin-right: 8px; flex-shrink: 0; }
        .c-sight { background-color: #007bff; } /* Blauw */
        .c-food { background-color: #dc3545; }  /* Rood */
        .c-act { background-color: #9c27b0; }   /* Paars */
        .c-hike { background-color: #28a745; }  /* Groen */

        /* Custom Pins op kaart */
        .custom-pin {
            border-radius: 50% 50% 50% 0;
            border: 2px solid #fff;
            width: 32px;
            height: 32px;
            transform: rotate(-45deg);
            display: flex !important;
            align-items: center;
            justify-content: center;
            box-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            transition: all 0.2s ease;
        }
        
        .custom-pin span {
            transform: rotate(45deg);
            color: white;
            font-weight: 800;
            font-size: 11px;
            font-family: Arial, sans-serif;
        }

        .custom-pin:hover { transform: scale(1.2) rotate(-45deg); z-index: 9999 !important; border-color: #ffff00; }

        .marker-sight { background-color: #007bff; }
        .marker-food { background-color: #dc3545; }
        .marker-act { background-color: #9c27b0; }
        .marker-hike { background-color: #28a745; }

        /* Popup Styling */
        .popup-content { min-width: 200px; }
        .popup-content h3 { margin: 0 0 5px 0; color: #333; }
        .popup-content .category { font-size: 11px; font-weight: bold; color: #888; text-transform: uppercase; margin-bottom: 5px; }
        .popup-content .desc { font-size: 13px; color: #555; margin-bottom: 8px; line-height: 1.4; }
        .popup-content .meta { display: flex; justify-content: space-between; font-size: 12px; font-weight: bold; color: #333; border-top: 1px solid #eee; padding-top: 5px; }
        
        .nav-btn {
            display: block;
            background: #4285F4; /* Google Blue */
            color: white;
            text-align: center;
            padding: 10px;
            text-decoration: none;
            border-radius: 6px;
            margin-top: 10px;
            font-weight: bold;
            font-size: 13px;
            transition: background 0.2s;
        }
        .nav-btn:hover { background: #3367D6; }

        /* Location Button */
        .loc-btn {
            width: 100%; padding: 12px; background: #222; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin-top: 15px; display: flex; align-items: center; justify-content: center;
        }
        .loc-btn:hover { background: #444; }

    </style>
</head>
<body>

    <div id="controls">
        <h2>üáπüá≠ Thailand Explorer</h2>
        
        <div class="slider-container">
            <h4>üèÜ Ranking Filter</h4>
            <label>Toon Top <span id="rankVal" class="slider-val">50</span></label>
            <input type="range" id="rankSlider" min="1" max="50" value="50">
            <small style="color:#888;">Schuif naar links voor alleen de absolute top.</small>
        </div>

        <div class="filter-group">
            <h4>Categorie√´n</h4>
            <label><input type="checkbox" name="cat" value="sight" checked> <span class="legend-color c-sight"></span> Bezienswaardigheden</label>
            <label><input type="checkbox" name="cat" value="food" checked> <span class="legend-color c-food"></span> Eten & Drinken</label>
            <label><input type="checkbox" name="cat" value="activity" checked> <span class="legend-color c-act"></span> Activiteiten</label>
            <label><input type="checkbox" name="cat" value="hike" checked> <span class="legend-color c-hike"></span> Wandelingen</label>
        </div>

        <div class="filter-group">
            <h4>Regio's</h4>
            <label><input type="checkbox" name="reg" value="bangkok" checked> Centraal & Bangkok</label>
            <label><input type="checkbox" name="reg" value="north" checked> Noord (Chiang Mai/Rai)</label>
            <label><input type="checkbox" name="reg" value="south" checked> Zuid (Eilanden/Krabi)</label>
            <label><input type="checkbox" name="reg" value="west" checked> West (Kanchanaburi)</label>
            <label><input type="checkbox" name="reg" value="east" checked> Oost (Pattaya/Isaan)</label>
        </div>

        <div class="filter-group">
            <h4>Prijsklasse</h4>
            <select id="priceFilter">
                <option value="all">Alle prijzen</option>
                <option value="free">Gratis</option>
                <option value="cheap">Budget (< ‚Ç¨5)</option>
                <option value="mid">Gemiddeld (‚Ç¨5 - ‚Ç¨20)</option>
                <option value="high">Luxe (> ‚Ç¨20)</option>
            </select>
        </div>

        <button class="loc-btn" onclick="locateUser()">
            <span style="margin-right:8px">üìç</span> Mijn Locatie
        </button>
        <div id="user-status" style="font-size: 11px; margin-top: 5px; color: #666; text-align: center;"></div>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // 1. Initialisatie Kaart
        const map = L.map('map').setView([13.0000, 101.5000], 6); // Zoom level aangepast voor overzicht

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap &copy; CARTO',
            maxZoom: 19
        }).addTo(map);

        // 2. Data Objecten (Met toegevoegde regio's)
        const locations = [
            // --- BEZIENSWAARDIGHEDEN (BLAUW) ---
            { rank: 1, type: 'sight', region: 'bangkok', name: "The Grand Palace", lat: 13.7500, lng: 100.4915, price: "‚Ç¨ 13,50", desc: "H√©t symbool van Thailand." },
            { rank: 2, type: 'sight', region: 'bangkok', name: "Wat Arun", lat: 13.7437, lng: 100.4888, price: "‚Ç¨ 5,40", desc: "Tempel van de Dageraad." },
            { rank: 3, type: 'sight', region: 'bangkok', name: "Ayutthaya Historical Park", lat: 14.3532, lng: 100.5684, price: "‚Ç¨ 1,35", desc: "Oude tempelru√Ønes." },
            { rank: 4, type: 'sight', region: 'south', name: "Maya Bay (Phi Phi)", lat: 7.6775, lng: 98.7663, price: "‚Ç¨ 10,80", desc: "Beroemd strand uit 'The Beach'." },
            { rank: 5, type: 'sight', region: 'north', name: "Wat Phra That Doi Suthep", lat: 18.8048, lng: 98.9216, price: "‚Ç¨ 0,80", desc: "Heilige bergtempel." },
            { rank: 6, type: 'sight', region: 'south', name: "Khao Sok National Park", lat: 8.9135, lng: 98.5309, price: "‚Ç¨ 8,10", desc: "Oerwoud en drijvende huisjes." },
            { rank: 7, type: 'sight', region: 'bangkok', name: "Damnoen Saduak Market", lat: 13.5195, lng: 99.9577, price: "Gratis (boot ‚Ç¨‚Ç¨)", desc: "Drijvende markt." },
            { rank: 8, type: 'sight', region: 'bangkok', name: "Wat Pho", lat: 13.7465, lng: 100.4933, price: "‚Ç¨ 8,10", desc: "Liggende Boeddha." },
            { rank: 9, type: 'sight', region: 'west', name: "Bridge over River Kwai", lat: 14.0410, lng: 99.5042, price: "Gratis", desc: "WO2 Historie." },
            { rank: 10, type: 'sight', region: 'south', name: "Railay Beach", lat: 8.0110, lng: 98.8373, price: "Gratis", desc: "Kalksteenkliffen strand." },
            { rank: 12, type: 'sight', region: 'north', name: "Wat Rong Khun (Witte Tempel)", lat: 19.8243, lng: 99.7632, price: "‚Ç¨ 2,70", desc: "Moderne kunsttempel." },
            { rank: 13, type: 'sight', region: 'north', name: "Sukhothai Historical Park", lat: 17.0163, lng: 99.7036, price: "‚Ç¨ 2,70", desc: "Oerste hoofdstad." },
            { rank: 18, type: 'sight', region: 'east', name: "Sanctuary of Truth", lat: 12.9727, lng: 100.8891, price: "‚Ç¨ 13,50", desc: "Houten tempel aan zee." },
            { rank: 25, type: 'sight', region: 'bangkok', name: "Jim Thompson House", lat: 13.7495, lng: 100.5283, price: "‚Ç¨ 5,40", desc: "Thais houten huis & zijde." },
            
            // --- ETEN (ROOD) ---
            { rank: 1, type: 'food', region: 'bangkok', name: "Raan Jay Fai", lat: 13.7525, lng: 100.5048, price: "‚Ç¨ 20+", desc: "Michelin streetfood (Krabomelet)." },
            { rank: 2, type: 'food', region: 'bangkok', name: "Jeh O Chula", lat: 13.7425, lng: 100.5225, price: "‚Ç¨ 6,75", desc: "Tom Yum Mama Noodles." },
            { rank: 3, type: 'food', region: 'north', name: "Khao Soi Khun Yai", lat: 18.7953, lng: 98.9831, price: "‚Ç¨ 1,35", desc: "Beste Khao Soi in Chiang Mai." },
            { rank: 4, type: 'food', region: 'bangkok', name: "Thipsamai Pad Thai", lat: 13.7528, lng: 100.5048, price: "‚Ç¨ 3,50", desc: "Beroemdste Pad Thai." },
            { rank: 5, type: 'food', region: 'bangkok', name: "Wattana Panich", lat: 13.7341, lng: 100.5876, price: "‚Ç¨ 2,70", desc: "50-jaar oude soepbouillon." },
            { rank: 6, type: 'food', region: 'south', name: "Tu Kab Khao", lat: 7.8836, lng: 98.3880, price: "‚Ç¨ 12,00", desc: "Zuid-Thais in Phuket Town." },
            { rank: 10, type: 'food', region: 'north', name: "Khao Soi Mae Sai", lat: 18.7996, lng: 98.9752, price: "‚Ç¨ 1,35", desc: "Rijke bouillon Khao Soi." },
            { rank: 12, type: 'food', region: 'bangkok', name: "Jok Prince", lat: 13.7196, lng: 100.5153, price: "‚Ç¨ 1,50", desc: "Rijstepap ontbijt." },
            { rank: 22, type: 'food', region: 'bangkok', name: "T&K Seafood", lat: 13.7410, lng: 100.5085, price: "‚Ç¨ 10,00", desc: "Street seafood in Chinatown." },
            { rank: 30, type: 'food', region: 'bangkok', name: "Pier 21 Food Court", lat: 13.7376, lng: 100.5603, price: "‚Ç¨ 1,50", desc: "Goedkoopste schone streetfood." },
            { rank: 32, type: 'food', region: 'south', name: "Kodam Kitchen", lat: 8.0336, lng: 98.8286, price: "‚Ç¨ 6,00", desc: "Beste in Ao Nang." },

            // --- ACTIVITEITEN (PAARS) ---
            { rank: 1, type: 'activity', region: 'bangkok', name: "Thaise Massage (Wat Pho)", lat: 13.7460, lng: 100.4930, price: "‚Ç¨ 8,00", desc: "De bron van de massage." },
            { rank: 4, type: 'activity', region: 'north', name: "Olifantenreservaat (ENP)", lat: 19.2155, lng: 98.8606, price: "‚Ç¨ 60,00", desc: "Ethische opvang, no riding." },
            { rank: 5, type: 'activity', region: 'bangkok', name: "Kookcursus (Silom)", lat: 13.7242, lng: 100.5234, price: "‚Ç¨ 30,00", desc: "Leer curry maken." },
            { rank: 15, type: 'activity', region: 'south', name: "Full Moon Party", lat: 9.6766, lng: 100.0631, price: "‚Ç¨ 3,00", desc: "Strandfeest Koh Phangan." },
            { rank: 28, type: 'activity', region: 'bangkok', name: "Sak Yant Tattoo", lat: 13.9168, lng: 100.2078, price: "Donatie", desc: "Heilige tatoeage (Wat Bang Phra)." },
            { rank: 30, type: 'activity', region: 'bangkok', name: "Chatuchak Market", lat: 13.7998, lng: 100.5504, price: "Gratis", desc: "Grootste weekendmarkt." },
            { rank: 40, type: 'activity', region: 'bangkok', name: "Varanen in Lumpini Park", lat: 13.7314, lng: 100.5414, price: "Gratis", desc: "Stadspark vol dieren." },
            { rank: 50, type: 'activity', region: 'bangkok', name: "Ancient City", lat: 13.5390, lng: 100.6226, price: "‚Ç¨ 20,00", desc: "Thailand in het klein." },

            // --- WANDELINGEN (GROEN) ---
            { rank: 1, type: 'hike', region: 'north', name: "Kew Mae Pan Nature Trail", lat: 18.5527, lng: 98.4801, price: "‚Ç¨ 5,50", desc: "Boven de wolken op Doi Inthanon." },
            { rank: 2, type: 'hike', region: 'south', name: "Dragon Crest (Ngorn Nak)", lat: 8.0973, lng: 98.7494, price: "Gratis", desc: "Spectaculair uitzicht Krabi." },
            { rank: 3, type: 'hike', region: 'north', name: "Monk's Trail (Wat Pha Lat)", lat: 18.7963, lng: 98.9435, price: "Gratis", desc: "Junglepad naar tempel." },
            { rank: 4, type: 'hike', region: 'south', name: "Phraya Nakhon Cave", lat: 12.2059, lng: 100.0102, price: "‚Ç¨ 5,40", desc: "Grot met paviljoen." },
            { rank: 5, type: 'hike', region: 'west', name: "Erawan Waterfalls", lat: 14.3755, lng: 99.1440, price: "‚Ç¨ 8,10", desc: "7 waterval niveaus." },
            { rank: 6, type: 'hike', region: 'west', name: "Khao Chang Phueak", lat: 14.6543, lng: 98.5413, price: "‚Ç¨ 10,00", desc: "Gevaarlijke bergrug." },
            { rank: 8, type: 'hike', region: 'north', name: "Phu Chi Fa", lat: 19.8500, lng: 100.4460, price: "Gratis", desc: "Zonsopgang op klif." },
            { rank: 9, type: 'hike', region: 'south', name: "Tiger Cave Temple (1237 treden)", lat: 8.1239, lng: 98.9251, price: "Gratis", desc: "Zware klim naar Boeddha." },
            { rank: 13, type: 'hike', region: 'north', name: "Pai Canyon", lat: 19.3060, lng: 98.4526, price: "Gratis", desc: "Smalle zandrichels." },
            { rank: 14, type: 'hike', region: 'north', name: "Sticky Waterfalls", lat: 19.0833, lng: 99.0833, price: "Gratis", desc: "In de waterval lopen." },
            { rank: 27, type: 'hike', region: 'bangkok', name: "Bang Kachao (Green Lung)", lat: 13.6828, lng: 100.5600, price: "Gratis", desc: "Fietsen/lopen in stad." },

            // Foutieve data test (Amsterdam) - wordt automatisch gefilterd
            { rank: 99, type: 'activity', region: 'north', name: "Test Fout", lat: 52.3862, lng: 4.8847, price: "‚Ç¨ 50,00", desc: "FOUT: In Amsterdam" }
        ];

        let markers = [];

        // 3. Functie: Filteren & Plaatsen
        function renderMarkers() {
            // Verwijder oude markers
            markers.forEach(m => map.removeLayer(m));
            markers = [];

            // Haal waarden uit filters
            const maxRank = parseInt(document.getElementById('rankSlider').value);
            const priceFilter = document.getElementById('priceFilter').value;
            
            // Checkboxes
            const catChecked = Array.from(document.querySelectorAll('input[name="cat"]:checked')).map(cb => cb.value);
            const regChecked = Array.from(document.querySelectorAll('input[name="reg"]:checked')).map(cb => cb.value);

            locations.forEach(loc => {
                // A. Geo-fence (Alleen Thailand)
                if (loc.lat < 5 || loc.lat > 21 || loc.lng < 97 || loc.lng > 106) return;

                // B. Ranking Filter (Slider)
                if (loc.rank > maxRank) return;

                // C. Categorie Filter
                if (!catChecked.includes(loc.type)) return;

                // D. Regio Filter
                if (!regChecked.includes(loc.region)) return;

                // E. Prijs Filter
                if (priceFilter !== 'all') {
                    if (priceFilter === 'free' && !loc.price.toLowerCase().includes('gratis')) return;
                    // Simpele logica voor budget/mid/high
                    const isCheap = loc.price.includes('‚Ç¨ 1') || loc.price.includes('‚Ç¨ 2') || loc.price.includes('‚Ç¨ 3') || loc.price.includes('‚Ç¨ 4');
                    const isMid = !isCheap && (parseInt(loc.price.replace(/[^0-9]/g, '')) < 20);
                    
                    if (priceFilter === 'cheap' && !isCheap && !loc.price.toLowerCase().includes('gratis')) return;
                    if (priceFilter === 'mid' && !isMid) return;
                    if (priceFilter === 'high' && (isCheap || isMid || loc.price.toLowerCase().includes('gratis'))) return;
                }

                // Bepaal kleur
                let cssClass = `marker-${loc.type}`;

                // Maak Pin
                const customIcon = L.divIcon({
                    className: 'custom-div-icon',
                    html: `<div class="custom-pin ${cssClass}"><span>${loc.rank}</span></div>`,
                    iconSize: [32, 44],
                    iconAnchor: [16, 42],
                    popupAnchor: [0, -45]
                });

                // Maak Marker
                const marker = L.marker([loc.lat, loc.lng], { icon: customIcon }).addTo(map);
                
                // Google Maps Link (Universeel)
                const gmapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${loc.lat},${loc.lng}`;

                // Popup HTML
                const popupContent = `
                    <div class="popup-content">
                        <div class="category">${getTypeName(loc.type)} - Rank #${loc.rank}</div>
                        <h3>${loc.name}</h3>
                        <div class="desc">${loc.desc}</div>
                        <div class="meta">
                            <span>üìç ${getRegionName(loc.region)}</span>
                            <span style="color:${loc.price.includes('Gratis') ? 'green' : 'black'}">${loc.price}</span>
                        </div>
                        <a href="${gmapsUrl}" target="_blank" class="nav-btn">üöó Navigeer in Google Maps</a>
                    </div>
                `;

                marker.bindPopup(popupContent);
                markers.push(marker);
            });
        }

        // Helpers voor leesbare tekst
        function getTypeName(type) {
            const types = { 'sight': 'Bezienswaardigheid', 'food': 'Eten & Drinken', 'activity': 'Activiteit', 'hike': 'Wandeling' };
            return types[type] || type;
        }

        function getRegionName(reg) {
            const regs = { 'bangkok': 'Centraal', 'north': 'Noord', 'south': 'Zuid', 'west': 'West', 'east': 'Oost' };
            return regs[reg] || reg;
        }

        // 4. Locatie Functie
        function locateUser() {
            const statusDiv = document.getElementById('user-status');
            if (!navigator.geolocation) {
                statusDiv.innerText = "Geen GPS ondersteuning.";
                return;
            }
            statusDiv.innerText = "Locatie zoeken...";
            navigator.geolocation.getCurrentPosition((position) => {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;
                
                L.marker([lat, lng]).addTo(map).bindPopup("<b>Jij bent hier</b>").openPopup();
                map.setView([lat, lng], 10);
                statusDiv.innerText = "";
            }, () => {
                statusDiv.innerText = "Kan locatie niet bepalen.";
            });
        }

        // 5. Event Listeners
        // Slider update
        document.getElementById('rankSlider').addEventListener('input', (e) => {
            document.getElementById('rankVal').innerText = e.target.value;
            renderMarkers();
        });

        // Alle inputs en selects triggeren een re-render
        document.querySelectorAll('input, select').forEach(el => {
            el.addEventListener('change', renderMarkers);
        });

        // Start applicatie
        renderMarkers();

    </script>
</body>
</html>
